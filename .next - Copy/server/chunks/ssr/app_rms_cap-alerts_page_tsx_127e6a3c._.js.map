{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/offic/OneDrive/Documents/PROJECTS%20LIVE%20NOW/your-portal/app/rms/cap-alerts/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Card,\r\n  CardContent,\r\n  Grid,\r\n  CircularProgress,\r\n  Button,\r\n  IconButton,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  TextField,\r\n  useTheme,\r\n  Snackbar,\r\n  Alert,\r\n} from '@mui/material';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport AddCircleOutlineIcon from '@mui/icons-material/AddCircleOutline';\r\n\r\ninterface CapAlert {\r\n  _id: string;\r\n  title: string;\r\n  description: string;\r\n  severity: string;\r\n  effective: string;\r\n  expires: string;\r\n}\r\n\r\nexport default function CapAlertsPage() {\r\n  const theme = useTheme();\r\n  const [alerts, setAlerts] = useState<CapAlert[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [openDialog, setOpenDialog] = useState(false);\r\n  const [form, setForm] = useState<Omit<CapAlert, '_id'>>({\r\n    title: '',\r\n    description: '',\r\n    severity: '',\r\n    effective: '',\r\n    expires: '',\r\n  });\r\n  const [snackbar, setSnackbar] = useState({ open: false, message: '', severity: 'success' });\r\n\r\n  const fetchAlerts = async () => {\r\n    try {\r\n      const res = await fetch('/api/cap-alerts');\r\n      const data = await res.json();\r\n      if (data.success) setAlerts(data.data);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const addAlert = async () => {\r\n    try {\r\n      const res = await fetch('/api/cap-alerts', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(form),\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        setAlerts((prev) => [...prev, data.data]);\r\n        setSnackbar({ open: true, message: 'Alert added', severity: 'success' });\r\n        setOpenDialog(false);\r\n        setForm({ title: '', description: '', severity: '', effective: '', expires: '' });\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      setSnackbar({ open: true, message: 'Failed to add alert', severity: 'error' });\r\n    }\r\n  };\r\n\r\n  const deleteAlert = async (id: string) => {\r\n    try {\r\n      const res = await fetch(`/api/cap-alerts?id=${id}`, {\r\n        method: 'DELETE',\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        setAlerts((prev) => prev.filter((a) => a._id !== id));\r\n        setSnackbar({ open: true, message: 'Alert deleted', severity: 'info' });\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchAlerts();\r\n  }, []);\r\n\r\n  return (\r\n    <Box sx={{ p: 4 }}>\r\n      <Box display=\"flex\" justifyContent=\"space-between\" mb={3}>\r\n        <Typography variant=\"h4\" fontWeight=\"bold\">\r\n          CAP Alerts\r\n        </Typography>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          startIcon={<AddCircleOutlineIcon />}\r\n          onClick={() => setOpenDialog(true)}\r\n        >\r\n          Add Alert\r\n        </Button>\r\n      </Box>\r\n\r\n      {loading ? (\r\n        <Box display=\"flex\" justifyContent=\"center\" mt={10}>\r\n          <CircularProgress />\r\n        </Box>\r\n      ) : alerts.length === 0 ? (\r\n        <Typography>No alerts found.</Typography>\r\n      ) : (\r\n        <Grid container spacing={3}>\r\n          {alerts.map((alert) => (\r\n            <Grid item xs={12} md={6} lg={4} key={alert._id}>\r\n              <Card sx={{ borderRadius: 4, boxShadow: 4, position: 'relative' }}>\r\n                <CardContent>\r\n                  <Typography variant=\"h6\" gutterBottom>\r\n                    {alert.title}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"textSecondary\" sx={{ mb: 1 }}>\r\n                    {alert.description}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\">\r\n                    <strong>Severity:</strong> {alert.severity}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\">\r\n                    <strong>Effective:</strong> {new Date(alert.effective).toLocaleString()}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\">\r\n                    <strong>Expires:</strong> {new Date(alert.expires).toLocaleString()}\r\n                  </Typography>\r\n                </CardContent>\r\n                <IconButton\r\n                  sx={{ position: 'absolute', top: 8, right: 8 }}\r\n                  onClick={() => deleteAlert(alert._id)}\r\n                >\r\n                  <DeleteIcon color=\"error\" />\r\n                </IconButton>\r\n              </Card>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      )}\r\n\r\n      <Dialog open={openDialog} onClose={() => setOpenDialog(false)} fullWidth>\r\n        <DialogTitle>Add CAP Alert</DialogTitle>\r\n        <DialogContent>\r\n          <TextField fullWidth label=\"Title\" margin=\"normal\" value={form.title} onChange={(e) => setForm({ ...form, title: e.target.value })} />\r\n          <TextField fullWidth label=\"Description\" margin=\"normal\" value={form.description} onChange={(e) => setForm({ ...form, description: e.target.value })} />\r\n          <TextField fullWidth label=\"Severity\" margin=\"normal\" value={form.severity} onChange={(e) => setForm({ ...form, severity: e.target.value })} />\r\n          <TextField fullWidth label=\"Effective Date\" type=\"datetime-local\" margin=\"normal\" InputLabelProps={{ shrink: true }} value={form.effective} onChange={(e) => setForm({ ...form, effective: e.target.value })} />\r\n          <TextField fullWidth label=\"Expiry Date\" type=\"datetime-local\" margin=\"normal\" InputLabelProps={{ shrink: true }} value={form.expires} onChange={(e) => setForm({ ...form, expires: e.target.value })} />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setOpenDialog(false)}>Cancel</Button>\r\n          <Button variant=\"contained\" onClick={addAlert}>\r\n            Submit\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Snackbar open={snackbar.open} autoHideDuration={3000} onClose={() => setSnackbar({ ...snackbar, open: false })}>\r\n        <Alert severity={snackbar.severity as any}>{snackbar.message}</Alert>\r\n      </Snackbar>\r\n    </Box>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}